# Documentation of the project's structure

## Overview

The aim of this project is to allow for 3D printing over the internet (more general information and how to use it in `README.md`).
It was designed for a printer inside a network where it was impossible to setup a server with a public IP address.

That is the reason why this project has two parts. The first part is the server part located in the folder `server` and containing a Django project
which runs on a server with public IP and enables the users to send command to the 3D printer from their desktop.
The second part is the raspberry part inside the `raspberry` folder. This runs on a raspberry directly connected to the Prusa Mini 3D printer,
connects to the server and transers the commands from the server to the printer.

## Server

The web application running on the server was written in Django and lives in the folder `server`.

This follder has two subfolders -- `server/server` which contains mostly configuration files autogenerated by Django and `server/printing` contatining the web app itself.

### Configuration files

These are located in the folder `server/server` and contain the following files:

- `settings.py` - Contains all the settings for the Django project.
- `urls.py` - The urls defined in the Django application. Except for the *admin* url, this merely includes urls from `server/print/urls.py`.
- `jinja2.py` - Defines an environment for Jinja2 which is used in the web application.

and `wsgi.py` and `asgi.py` providing settings for the deploy which were autogenerated.

### Back-end files

All the back-end files lie directly in the `server/printing` folder.

The `urls.py` list all the URLs which corespond to a valid page. Each url in the list has a corresponding view function.

The view functions are defined in the `views.py` file and they provide the back-end handling of each request.
The views were written with the Django mantra *keep views thin* in mind. Due to this, additional back-end behaviour is defined in
`controllers.py`. This defines functions which mostly implement file storing.

The file `forms.py` provides a definition of forms which are passed to the frontend in the views. These implement the structure of all the frontend forms.

The file `tests.py` contains unit tests for the backend.

### Front-end files

All the HTML pages are stored in the folder `server/printing/templates`.

The basic structure of each HTML page is defined in the file `layout.html` which is included by all the other HTML files.

`form.html` defines a simple pages including a Django form. It's used both in gcode sending and in login.

The styles are defined in the file `server/printing/static/style.css` which defines the basic styling for all pages.

## Raspberry

All the files for raspberry can be found in the subdirectory `raspberry`.

The heart of the application running on raspberry is the python file `main_controller.py`. This contains all the high-level logic of what should be done next.

The file `gcode_sender.py` is responsible for communication with the 3D printer and sending appropriate gcodes to the printer.

The file `file_loader.py` handles reading from and writing to the files on the server. It connects to the server via ssh and returns results of appropriate bash commands to the high level functions.

`tests.py` contains unit tests for the code on raspberry.


